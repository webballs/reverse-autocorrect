<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reverse Autocorrect</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="cursor.css">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background: #ffffff;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
    color: #111827;
    cursor: none;
  }

  h1 { margin-bottom: 1rem; font-weight: 700; }

  textarea {
    width: 80%;
    max-width: 600px;
    height: 120px;
    padding: 1rem;
    font-size: 1rem;
    border-radius: 12px;
    border: 2px solid #d1d5db;
    outline: none;
    resize: none;
    background: white;
    color: #111827;
    font-family: 'Poppins', sans-serif;
    transition: border-color 0.25s ease, box-shadow 0.25s ease;
  }

  textarea:focus {
    border-color: #0085ff;
    box-shadow: 0 0 8px rgba(0,133,255,0.3);
  }

  .btn-3d-wrap { perspective: 1600px; margin-top: 1rem; }

  #reverseBtn {
    padding: 1rem 2rem;
    font-size: 1.2rem;
    border: none;
    border-radius: 16px;
    background: linear-gradient(135deg, #0096ff, #006eff);
    color: white;
    cursor: pointer;
    font-weight: 600;
    transform-style: preserve-3d;
    box-shadow: 0 15px 30px rgba(0,0,0,0.15);
    will-change: transform, box-shadow;
    transition: transform 0.1s ease, box-shadow 0.1s ease, background 0.3s ease;
  }

  #reverseBtn:hover {
    background: linear-gradient(135deg, #00a6ff, #0076ff);
  }

  #reverseBtn:active { transform: scale(0.95); }

  /* --- Button Down Animation --- */
  @keyframes buttonDown {
    0% {
      transform: translateY(0) scale(1);
      box-shadow: 0 15px 30px rgba(0,0,0,0.15);
    }
    40% {
      transform: translateY(0px) scale(0.97);
      box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    }
    100% {
      transform: translateY(0) scale(1);
      box-shadow: 0 15px 30px rgba(0,0,0,0.15);
    }
  }
  .reverse-press { animation: buttonDown 0.25s ease; }

  .output {
    position: relative;
    margin-top: 1.5rem;
    width: 80%;
    max-width: 600px;
    background: white;
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 4px 8px rgba(0,0,0,0.08);
    font-size: 1.1rem;
    min-height: 80px;
    white-space: pre-wrap;
    font-family: 'Poppins', sans-serif;
  }

  .fall { display: inline-block; transform: translateY(-1px); animation: fall 0.05s forwards; }
  @keyframes fall { to { transform: translateY(0); } }

  #copyBtn {
    position: absolute; bottom: 8px; right: 8px;
    padding: 4px 10px; font-size: 0.85rem;
    border-radius: 8px; border: none; background: white; color: #555;
    cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  #copyBtn:hover { background: #f0f0f0; }

  .sliders {
    margin-top: 12px;
    width: 80%;
    max-width: 600px;
    display: flex;
    flex-direction: column;
    gap: 6px;
  }
  .slider-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
  }
  .slider-row label { font-weight: 600; flex: 1; text-align: left; }
  .slider-row span { font-weight: 600; width: 45px; text-align: right; }
  .slider-row input[type=range] {
    -webkit-appearance: none;
    flex: 3;
    height: 14px;
    background: #e0e0e0;
    border-radius: 9999px;
    position: relative;
    cursor: pointer;
  }
  .slider-row input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 24px;
    height: 24px;
    background: white;
    border: 2px solid #888;
    border-radius: 50%;
    margin-top: -5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  }

  #resetBtn {
    align-self: flex-end;
    margin-top: 10px;
    padding: 5px 12px;
    font-size: 0.85rem;
    border-radius: 8px;
    border: 1px solid #ccc;
    background: white;
    color: #333;
    cursor: pointer;
    transition: all 0.2s ease;
  }
  #resetBtn:hover { background: #f0f0f0; }

  .cursor-circle-outer {
    position: fixed; width: 30px; height: 30px;
    background: rgba(128,128,128,0.25);
    border: 2px solid rgba(128,128,128,0.5);
    border-radius: 50%;
    pointer-events: none;
    z-index: 1000;
    transform: translate(-50%, -50%) scale(1);
    transition: transform 0.1s ease, opacity 0.3s ease;
  }
  .cursor-circle-inner {
    position: fixed; width: 8px; height: 8px;
    background: black;
    border-radius: 50%;
    pointer-events: none;
    z-index: 1001;
    transform: translate(-50%, -50%) scale(1);
    transition: transform 0.1s ease, opacity 0.3s ease;
  }
</style>
</head>
<body>
<h1>Reverse Autocorrect</h1>

<textarea id="inputText" placeholder="Type something correctly..." spellcheck="false" autocorrect="off" autocomplete="off" autocapitalize="off"></textarea>

<div class="sliders">
  <div class="slider-row"><label>Error Rate</label><input id="errorSlider" type="range" min="0" max="100" value="50"><span id="errorValue">50%</span></div>
  <div class="slider-row"><label>Swap Letters</label><input id="swapSlider" type="range" min="0" max="100" value="15"><span id="swapValue">15%</span></div>
  <div class="slider-row"><label>Delete Letters</label><input id="deleteSlider" type="range" min="0" max="100" value="15"><span id="deleteValue">15%</span></div>
  <div class="slider-row"><label>Duplicate Letters</label><input id="duplicateSlider" type="range" min="0" max="100" value="15"><span id="duplicateValue">15%</span></div>
  <div class="slider-row"><label>Replace Similar</label><input id="replaceSlider" type="range" min="0" max="100" value="15"><span id="replaceValue">15%</span></div>
  <div class="slider-row"><label>Nearby Keys</label><input id="nearbySlider" type="range" min="0" max="100" value="15"><span id="nearbyValue">15%</span></div>
  <button id="resetBtn">Reset</button>
</div>

<div class="btn-3d-wrap">
  <button id="reverseBtn">Reverse it!</button>
</div>

<div class="output" id="outputText">
  <button id="copyBtn">Copy</button>
</div>

<div class="cursor-circle-outer" id="cursorOuter"></div>
<div class="cursor-circle-inner" id="cursorInner"></div>

<script>
// Slider setup
const sliders = [
  ['errorSlider','errorValue'],
  ['swapSlider','swapValue'],
  ['deleteSlider','deleteValue'],
  ['duplicateSlider','duplicateValue'],
  ['replaceSlider','replaceValue'],
  ['nearbySlider','nearbyValue']
];
const values = {};
for (const [id,val] of sliders){
  const s=document.getElementById(id), v=document.getElementById(val);
  s.addEventListener('input',()=>{v.textContent=s.value+'%'; values[id]=parseFloat(s.value)/100;});
  values[id]=parseFloat(s.value)/100;
}

document.getElementById('resetBtn').addEventListener('click',()=>{
  const defaults=[50,15,15,15,15,15];
  sliders.forEach(([id,val],i)=>{
    const s=document.getElementById(id),v=document.getElementById(val);
    s.value=defaults[i];v.textContent=defaults[i]+'%';values[id]=defaults[i]/100;
  });
});

// Reverse autocorrect
function swapLetters(w){if(w.length<2)return w;const i=Math.floor(Math.random()*(w.length-1));return w.slice(0,i)+w[i+1]+w[i]+w.slice(i+2);}
function deleteRandomLetter(w){if(w.length<=3)return w;const i=Math.floor(Math.random()*w.length);return w.slice(0,i)+w.slice(i+1);}
function duplicateRandomLetter(w){const i=Math.floor(Math.random()*w.length);return w.slice(0,i)+w[i]+w[i]+w.slice(i+1);}
function replaceWithSimilarLetter(w){const s={a:['e','o'],e:['a','i'],i:['u','y'],o:['a','u'],s:['z','x'],t:['r','y'],c:['k','s']};const a=w.split('');const i=Math.floor(Math.random()*a.length);const c=a[i].toLowerCase();if(s[c])a[i]=s[c][Math.floor(Math.random()*s[c].length)];return a.join('');}
function replaceWithNearbyKeyInWord(w){const k={a:['s','q','w','z'],b:['v','g','h','n'],c:['x','d','f','v'],d:['s','e','r','f','c','x'],e:['w','s','d','r'],f:['d','r','t','g','v','c'],g:['f','t','y','h','b','v'],h:['g','y','u','j','n','b'],i:['u','j','k','o'],j:['h','u','i','k','m','n'],k:['j','i','o','l','m'],l:['k','o','p'],m:['n','j','k'],n:['b','h','j','m'],o:['i','k','l','p'],p:['o','l'],q:['w','a'],r:['e','d','f','t'],s:['a','w','e','d','x','z'],t:['r','f','g','y'],u:['y','h','j','i'],v:['c','f','g','b'],w:['q','a','s','e'],x:['z','s','d','c'],y:['t','g','h','u'],z:['a','s','x']};const a=w.split('');const i=Math.floor(Math.random()*a.length);const ch=a[i].toLowerCase();if(k[ch])a[i]=k[ch][Math.floor(Math.random()*k[ch].length)];return a.join('');}

function messUpWord(w){
  if(w.length<2)return w;
  if(Math.random()>values.errorSlider)return w;
  const m=[];
  if(Math.random()<values.swapSlider)m.push(()=>w=swapLetters(w));
  if(Math.random()<values.deleteSlider)m.push(()=>w=deleteRandomLetter(w));
  if(Math.random()<values.duplicateSlider)m.push(()=>w=duplicateRandomLetter(w));
  if(Math.random()<values.replaceSlider)m.push(()=>w=replaceWithSimilarLetter(w));
  if(Math.random()<values.nearbySlider)m.push(()=>w=replaceWithNearbyKeyInWord(w));
  if(m.length===0){
    const f=[swapLetters,deleteRandomLetter,duplicateRandomLetter,replaceWithSimilarLetter,replaceWithNearbyKeyInWord];
    w=f[Math.floor(Math.random()*f.length)](w);
  } else m.forEach(fn=>fn());
  return w;
}

const reverseBtn=document.getElementById('reverseBtn');
const output=document.getElementById('outputText');
const copyBtn=document.getElementById('copyBtn');

reverseBtn.addEventListener('click',()=>{
  reverseBtn.classList.add('reverse-press'); // NEW
  setTimeout(()=>reverseBtn.classList.remove('reverse-press'),250); // NEW

  const input=document.getElementById('inputText').value.trim();
  const words=input.split(' ');
  const messed=words.map(messUpWord);
  output.innerHTML='';output.appendChild(copyBtn);
  const spans=[];
  words.forEach((w,i)=>{
    const o=w,m=messed[i];const len=Math.max(o.length,m.length);
    for(let c=0;c<len;c++){
      const s=document.createElement('span');
      s.textContent=m[c]||'';s.dataset.isMistake=o[c]!==m[c]?'1':'0';
      s.style.color='transparent';output.appendChild(s);spans.push(s);
    }output.appendChild(document.createTextNode(' '));
  });
  let i=0;const total=spans.length;const interval=1000/total;
  (function show(){if(i>=total){setTimeout(()=>spans.forEach(s=>{if(s.dataset.isMistake==='1'){s.style.transition='background-color 0.2s ease';s.style.backgroundColor='rgba(255,0,0,0.2)';setTimeout(()=>s.style.backgroundColor='rgba(255,0,0,0.05)',1500);}}),500);return;}
    spans[i].style.color='#111827';spans[i].classList.add('fall');i++;setTimeout(show,interval);})();
});

copyBtn.addEventListener('click',()=>{navigator.clipboard.writeText(output.innerText);copyBtn.textContent='Copied!';setTimeout(()=>copyBtn.textContent='Copy',1000);});

/* 3D Tilt */
(function(){
  const btn=document.getElementById('reverseBtn');let raf=null,lastEvt=null;
  function applyTilt(){raf=null;if(!lastEvt)return;const r=btn.getBoundingClientRect();
    const x=(lastEvt.clientX-r.left)/r.width-0.5,y=(lastEvt.clientY-r.top)/r.height-0.5;
    const rotX=y*-35,rotY=x*50;btn.style.transform=`rotateX(${rotX}deg) rotateY(${rotY}deg) scale(1.05)`;
    btn.style.boxShadow=`${-rotY*1.2}px ${rotX*1.2}px 35px rgba(0,0,0,0.2)`;}
  btn.addEventListener('mousemove',e=>{lastEvt=e;if(!raf)raf=requestAnimationFrame(applyTilt);});
  btn.addEventListener('mouseenter',e=>{lastEvt=e;if(!raf)raf=requestAnimationFrame(applyTilt);btn.style.transition='transform 0.05s ease, box-shadow 0.05s ease';});
  btn.addEventListener('mouseleave',()=>{if(raf){cancelAnimationFrame(raf);raf=null;}lastEvt=null;
    btn.style.transition='transform 0.6s ease, box-shadow 0.6s ease';
    btn.style.transform='rotateX(0) rotateY(0) scale(1)';
    btn.style.boxShadow='0 15px 30px rgba(0,0,0,0.15)';
    setTimeout(()=>btn.style.transition='transform 0.1s ease, box-shadow 0.1s ease',600);});
})();

/* Cursor */
const outer=document.getElementById('cursorOuter'),inner=document.getElementById('cursorInner');
let mouse={x:window.innerWidth/2,y:window.innerHeight/2},pos={x:mouse.x,y:mouse.y};
document.addEventListener('mousemove',e=>{mouse.x=e.clientX;mouse.y=e.clientY;});
document.addEventListener('mousedown',()=>{inner.style.transform='translate(-50%,-50%) scale(0)';outer.style.transform='translate(-50%,-50%) scale(0.7)';});
document.addEventListener('mouseup',()=>{inner.style.transform='translate(-50%,-50%) scale(1)';outer.style.transform='translate(-50%,-50%) scale(1)';});
(function anim(){pos.x+=(mouse.x-pos.x)*0.1;pos.y+=(mouse.y-pos.y)*0.1;inner.style.left=pos.x+'px';inner.style.top=pos.y+'px';outer.style.left=pos.x+'px';outer.style.top=pos.y+'px';
const el=document.elementFromPoint(pos.x,pos.y);
if(el&&(el.tagName==='BUTTON'||el.tagName==='TEXTAREA'||el.type==='range'||el.id==='outputText')){inner.style.opacity=0.1;outer.style.opacity=0.1;}
else{inner.style.opacity=1;outer.style.opacity=1;}
requestAnimationFrame(anim);})();
</script>
<script src="cursor.js"></script>
</body>
</html>
