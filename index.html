<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reverse Autocorrect</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'Poppins', sans-serif;
    background: #ffffff;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    margin: 0;
    padding: 20px;
    color: #111827;
    cursor: none;
  }

  h1 { margin-bottom: 1rem; font-weight: 700; }

  textarea {
    width: 80%;
    max-width: 600px;
    height: 120px;
    padding: 1rem;
    font-size: 1rem;
    border-radius: 12px;
    border: 2px solid #d1d5db;
    outline: none;
    resize: none;
    background: white;
    color: #111827;
    font-family: 'Poppins', sans-serif;
  }

  .slider-group {
    width: 80%;
    max-width: 600px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-top: 16px;
  }

  .slider-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    width: 100%;
  }

  .slider-container label {
    flex: 1;
    font-weight: 600;
    text-align: left;
  }

  .slider-container input[type=range] {
    flex: 2;
    -webkit-appearance: none;
    height: 14px;
    background: #e0e0e0;
    border-radius: 9999px;
    cursor: pointer;
  }

  .slider-container input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 22px;
    height: 22px;
    background: white;
    border: 2px solid #888;
    border-radius: 50%;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  }

  .slider-container span {
    flex: 0 0 50px;
    text-align: right;
    font-weight: 600;
  }

  .btn-3d-wrap { perspective: 1600px; margin-top: 1.2rem; }
  button {
    padding: 1rem 2rem;
    font-size: 1.2rem;
    border: none;
    border-radius: 16px;
    background: rgb(0,133,255);
    color: white;
    cursor: pointer;
    font-weight: 600;
    transform-style: preserve-3d;
    box-shadow: 0 15px 30px rgba(0,0,0,0.15);
    transition: transform 0.1s ease, box-shadow 0.1s ease;
  }
  button:active { transform: scale(0.95); }

  #resetBtn {
    margin-top: 8px;
    background: #6b7280;
    font-size: 1rem;
    padding: 0.7rem 1.4rem;
  }
  #resetBtn:hover { background: #4b5563; }

  .output {
    position: relative;
    margin-top: 1.5rem;
    width: 80%;
    max-width: 600px;
    background: white;
    border-radius: 12px;
    padding: 1rem;
    box-shadow: 0 4px 8px rgba(0,0,0,0.08);
    font-size: 1.1rem;
    min-height: 80px;
    white-space: pre-wrap;
    font-family: 'Poppins', sans-serif;
  }

  .fall { display: inline-block; transform: translateY(-1px); animation: fall 0.05s forwards; }
  @keyframes fall { to { transform: translateY(0); } }

  #copyBtn {
    position: absolute; bottom: 8px; right: 8px;
    padding: 4px 10px; font-size: 0.85rem;
    border-radius: 8px; border: none; background: white; color: #555;
    cursor: pointer; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  #copyBtn:hover { background: #f0f0f0; }

  .cursor-circle-outer {
    position: fixed; width: 30px; height: 30px;
    background: rgba(128,128,128,0.25);
    border: 2px solid rgba(128,128,128,0.5);
    border-radius: 50%;
    pointer-events: none; 
    z-index: 1000;
    transform: translate(-50%, -50%) scale(1);
    transition: transform 0.1s ease, opacity 0.3s ease;
  }
  .cursor-circle-inner {
    position: fixed; width: 8px; height: 8px;
    background: black;
    border-radius: 50%;
    pointer-events: none; 
    z-index: 1001;
    transform: translate(-50%, -50%) scale(1);
    transition: transform 0.1s ease, opacity 0.3s ease;
  }

  @media (hover: none) {
    body { cursor: auto; }
    .cursor-circle-inner, .cursor-circle-outer { display: none; }
  }
</style>
</head>
<body>
<h1>Reverse Autocorrect</h1>

<textarea id="inputText" placeholder="Type something correctly..." spellcheck="false" autocorrect="off" autocomplete="off"></textarea>

<div class="slider-group">
  <div class="slider-container">
    <label for="errorSlider">Overall Error Rate</label>
    <input id="errorSlider" type="range" min="0" max="100" value="50">
    <span id="errorValue">50%</span>
  </div>

  <div class="slider-container">
    <label for="swapSlider">Swap Letters</label>
    <input id="swapSlider" type="range" min="0" max="100" value="15">
    <span id="swapValue">15%</span>
  </div>

  <div class="slider-container">
    <label for="deleteSlider">Delete Letters</label>
    <input id="deleteSlider" type="range" min="0" max="100" value="15">
    <span id="deleteValue">15%</span>
  </div>

  <div class="slider-container">
    <label for="duplicateSlider">Duplicate Letters</label>
    <input id="duplicateSlider" type="range" min="0" max="100" value="15">
    <span id="duplicateValue">15%</span>
  </div>

  <div class="slider-container">
    <label for="replaceSlider">Replace Letters (similar)</label>
    <input id="replaceSlider" type="range" min="0" max="100" value="15">
    <span id="replaceValue">15%</span>
  </div>

  <div class="slider-container">
    <label for="nearbySlider">Nearby Key Replacements</label>
    <input id="nearbySlider" type="range" min="0" max="100" value="15">
    <span id="nearbyValue">15%</span>
  </div>

  <button id="resetBtn">Reset Settings</button>
</div>

<div class="btn-3d-wrap">
  <button id="reverseBtn">Reverse it!</button>
</div>

<div class="output" id="outputText">
  <button id="copyBtn">Copy</button>
</div>

<div class="cursor-circle-outer" id="cursorOuter"></div>
<div class="cursor-circle-inner" id="cursorInner"></div>

<script>
/* --- Slider setup --- */
function setupSlider(id,valId,callback){
  const slider=document.getElementById(id);
  const valEl=document.getElementById(valId);
  slider.addEventListener('input',()=>{valEl.textContent=slider.value+'%'; callback(slider.value/100);});
  return slider.value/100;
}

let errorRate=setupSlider('errorSlider','errorValue',v=>errorRate=v);
let swapRate=setupSlider('swapSlider','swapValue',v=>swapRate=v);
let deleteRate=setupSlider('deleteSlider','deleteValue',v=>deleteRate=v);
let duplicateRate=setupSlider('duplicateSlider','duplicateValue',v=>duplicateRate=v);
let replaceRate=setupSlider('replaceSlider','replaceValue',v=>replaceRate=v);
let nearbyRate=setupSlider('nearbySlider','nearbyValue',v=>nearbyRate=v);

/* --- Error functions --- */
function swapLetters(w){ if(w.length<2) return w; const i=Math.floor(Math.random()*(w.length-1)); return w.slice(0,i)+w[i+1]+w[i]+w.slice(i+2);}
function deleteRandomLetter(w){ if(w.length<=1) return w; const i=Math.floor(Math.random()*w.length); return w.slice(0,i)+w.slice(i+1);}
function duplicateRandomLetter(w){ const i=Math.floor(Math.random()*w.length); return w.slice(0,i)+w[i]+w[i]+w.slice(i+1);}
function replaceWithSimilarLetter(w){ const s={a:['e','o'],e:['a','i'],i:['u','y'],o:['a','u'],s:['z','x'],t:['r','y'],c:['k','s']}; const arr=w.split(''); const i=Math.floor(Math.random()*arr.length); const ch=arr[i].toLowerCase(); if(s[ch]) arr[i]=s[ch][Math.floor(Math.random()*s[ch].length)]; return arr.join('');}
function replaceWithNearbyKey(c){ const q={a:['s','q','w','z'],b:['v','g','h','n'],c:['x','d','f','v'],d:['s','e','r','f','c','x'],e:['w','s','d','r'],f:['d','r','t','g','v','c'],g:['f','t','y','h','b','v'],h:['g','y','u','j','n','b'],i:['u','j','k','o'],j:['h','u','i','k','m','n'],k:['j','i','o','l','m'],l:['k','o','p'],m:['n','j','k'],n:['b','h','j','m'],o:['i','k','l','p'],p:['o','l'],q:['w','a'],r:['e','d','f','t'],s:['a','w','e','d','x','z'],t:['r','f','g','y'],u:['y','h','j','i'],v:['c','f','g','b'],w:['q','a','s','e'],x:['z','s','d','c'],y:['t','g','h','u'],z:['a','s','x']}; const l=c.toLowerCase(); if(q[l]) return q[l][Math.floor(Math.random()*q[l].length)]; return c;}
function replaceWithNearbyKeyInWord(w){ const idx=Math.floor(Math.random()*w.length); const arr=w.split(''); arr[idx]=replaceWithNearbyKey(arr[idx]); return arr.join('');}

/* --- Mess up word --- */
function messUpWord(word){
  if(Math.random()>errorRate) return word;

  let w=word;
  const mutations=[];

  if(Math.random()<swapRate) mutations.push(()=>w=swapLetters(w));
  if(Math.random()<deleteRate) mutations.push(()=>w=deleteRandomLetter(w));
  if(Math.random()<duplicateRate) mutations.push(()=>w=duplicateRandomLetter(w));
  if(Math.random()<replaceRate) mutations.push(()=>w=replaceWithSimilarLetter(w));
  if(Math.random()<nearbyRate) mutations.push(()=>w=replaceWithNearbyKeyInWord(w));

  if(mutations.length===0){
    const funcs=[()=>w=swapLetters(w),()=>w=deleteRandomLetter(w),()=>w=duplicateRandomLetter(w),()=>w=replaceWithSimilarLetter(w),()=>w=replaceWithNearbyKeyInWord(w)];
    funcs[Math.floor(Math.random()*funcs.length)]();
  } else { mutations.forEach(f=>f()); }

  return w;
}

/* --- Reset button --- */
document.getElementById('resetBtn').addEventListener('click',()=>{
  const defaults={errorSlider:50,swapSlider:15,deleteSlider:15,duplicateSlider:15,replaceSlider:15,nearbySlider:15};
  for(const [id,val] of Object.entries(defaults)){
    document.getElementById(id).value=val;
    document.getElementById(id.replace('Slider','Value')).textContent=val+'%';
  }
  errorRate=0.5; swapRate=deleteRate=duplicateRate=replaceRate=nearbyRate=0.15;
});

/* --- Reverse logic --- */
const reverseBtn=document.getElementById('reverseBtn');
const output=document.getElementById('outputText');
const copyBtn=document.getElementById('copyBtn');

function reverseAutocorrect(){
  const input=document.getElementById('inputText').value;
  const words=input.split(/(\s+)/);
  const messedWords=words.map(messUpWord);

  reverseBtn.style.transform='scale(0.9)';
  setTimeout(()=>reverseBtn.style.transform='',150);

  output.innerHTML='';
  output.appendChild(copyBtn);

  const spans=[];
  words.forEach((w,i)=>{
    const orig=w; const messed=messedWords[i]; const maxLen=Math.max(orig.length,messed.length);
    for(let c=0;c<maxLen;c++){
      const o=orig[c]||''; const m=messed[c]||'';
      const s=document.createElement('span');
      s.textContent=m;
      s.dataset.isMistake=o!==m?'1':'0';
      s.style.color='transparent';
      output.appendChild(s);
      spans.push(s);
    }
  });

  let idx=0;
  const interval=Math.max(5,1000/spans.length);
  function showNext(){
    if(idx>=spans.length){ setTimeout(highlightMistakes,500); return; }
    spans[idx].style.color='#111827'; spans[idx].classList.add('fall'); idx++;
    setTimeout(showNext,interval);
  }
  showNext();

  function highlightMistakes(){
    spans.forEach(s=>{ if(s.dataset.isMistake==='1'){ s.style.transition='background-color 0.2s ease'; s.style.backgroundColor='rgba(255,0,0,0.5)'; } });
    setTimeout(()=>{ spans.forEach(s=>{ if(s.dataset.isMistake==='1'){ s.style.transition='background-color 1.5s ease'; s.style.backgroundColor='rgba(255,0,0,0.1)'; } }); },1500);
  }
}

reverseBtn.addEventListener('click',reverseAutocorrect);
copyBtn.addEventListener('click',()=>{navigator.clipboard.writeText(output.innerText); copyBtn.textContent='Copied!'; setTimeout(()=>{copyBtn.textContent='Copy';},1000);});

/* --- 3D button tilt --- */
(function(){
  const btn=document.getElementById('reverseBtn'); const maxX=35; const maxY=50; let rect=null;
  function updateRect(){ rect=btn.getBoundingClientRect(); }
  updateRect(); window.addEventListener('resize',updateRect);
  btn.addEventListener('mousemove',e=>{
    if(!rect) return;
    const x=(e.clientX-rect.left)/rect.width-0.5;
    const y=(e.clientY-rect.top)/rect.height-0.5;
    const rotX=y*-maxX; const rotY=x*maxY;
    btn.style.transform=`rotateX(${rotX}deg) rotateY(${rotY}deg) scale(1.05)`;
    btn.style.boxShadow=`${-rotY*1.2}px ${rotX*1.2}px 35px rgba(0,0,0,0.2)`;
  });
  btn.addEventListener('mouseleave',()=>{
    btn.style.transition='transform 0.6s ease, box-shadow 0.6s ease';
    btn.style.transform='rotateX(0) rotateY(0) scale(1)';
    btn.style.boxShadow='0 15px 30px rgba(0,0,0,0.15)';
    setTimeout(()=>btn.style.transition='transform 0.1s ease, box-shadow 0.1s ease',600);
  });
})();

/* --- Custom cursor --- */
const cursorOuter=document.getElementById('cursorOuter'); const cursorInner=document.getElementById('cursorInner');
let mouse={x:window.innerWidth/2,y:window.innerHeight/2};
let pos={x:mouse.x,y:mouse.y};
document.addEventListener('mousemove',e=>{mouse.x=e.clientX; mouse.y=e.clientY;});
document.addEventListener('mousedown',()=>{cursorInner.style.transform='translate(-50%,-50%) scale(0)'; cursorOuter.style.transform='translate(-50%,-50%) scale(0.7)';});
document.addEventListener('mouseup',()=>{cursorInner.style.transform='translate(-50%,-50%) scale(1)'; cursorOuter.style.transform='translate(-50%,-50%) scale(1)';});
function animateCursor(){ const lerp=0.1; pos.x+=(mouse.x-pos.x)*lerp; pos.y+=(mouse.y-pos.y)*lerp; cursorInner.style.left=pos.x+'px'; cursorInner.style.top=pos.y+'px'; cursorOuter.style.left=pos.x+'px'; cursorOuter.style.top=pos.y+'px'; requestAnimationFrame(animateCursor);}
animateCursor();
</script>
</body>
</html>
